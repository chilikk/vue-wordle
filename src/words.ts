const defaultMessage = ' Using word of the day instead.'

export function getQuery() {
  if (location.search) {
    try {
      const queryraw = atob(location.search.slice(1))
      const queryutf8arr = Uint8Array.from(queryraw, c => c.charCodeAt(0))
      const query = new TextDecoder().decode(queryutf8arr)
      if (query.length !== 5) {
        alert(`Incorrect word length from encoded query. ${defaultMessage}`)
      } else {
        return query
      }
    } catch (e) {
      alert(`Malformed encoded word query. ${defaultMessage}`)
    }
  }
  return null
}

export function getDay(now: Date) {
  const start = new Date(2022, 1, 13)
  const diff = Number(now) - Number(start)
  const tzdiff = (now.getTimezoneOffset() - start.getTimezoneOffset()) * 60*1000
  let day = Math.floor((diff - tzdiff) / (1000 * 60 * 60 * 24))
  day %= answers.length
  return day+1
}

export function getWordOfTheDay(input) {
  if (typeof input === 'number') {
      return answers[input-1]
  } else if (typeof input === 'string') {
      return input
  }
}

// copied from Wordle source
const answers = [
    'энтер',
    'вдруг',
    'бельё',
    'юноша',
    'изъян',
    'чужак',
    'мираж',
    'свежо',
    'чайка',
    'навык',
    'щётка',
    'пчела',
    'глядь',
    'лютый',
    'съезд',
    'житьё',
    'шесть',
    'сёмга',
    'графа',
    'обряд',
    'грунт',
    'цифра',
    'рысью',
    'чернь',
    'индюк',
    'агнец',
    'сабля',
    'кухня',
    'вволю',
    'сжечь',
    'бычок',
    'замуж',
    'актёр',
    'танец',
    'негде',
    'жилой',
    'утечь',
    'слуга',
    'гвалт',
    'время',
    'юнкер',
    'упрёк',
    'гений',
    'почём',
    'сырой',
    'резня',
    'берег',
    'тощий',
    'кулёк',
    'крыша',
    'вслед',
    'хилый',
    'экран',
    'явный',
    'блуза',
    'щиток',
    'шофёр',
    'объём',
    'нигде',
    'глубь',
    'сизый',
    'кишмя',
    'улица',
    'свыше',
    'бытьё',
    'любая',
    'штаны',
    'стужа',
    'шорох',
    'вслух',
    'сборы',
    'рыбка',
    'фураж',
    'ночью',
    'поезд',
    'вялый',
    'сучок',
    'смерд',
    'вдаль',
    'хохот',
    'гнида',
    'гнуть',
    'ясный',
    'выезд',
    'свеча',
    'взмах',
    'поэма',
    'извоз',
    'почёт',
    'эпоха',
    'недуг',
    'сытый',
    'сущий',
    'гниль',
    'блоха',
    'фасад',
    'всюду',
    'фокус',
    'прочь',
    'шифон',
    'дрозд',
    'ларец',
    'вздор',
    'щёлка',
    'чутьё',
    'мешок',
    'блюдо',
    'бытиё',
    'тётка',
    'ладья',
    'слюна',
    'трюмо',
    'писец',
    'гумно',
    'через',
    'череп',
    'душно',
    'шайка',
    'жажда',
    'жёлоб',
    'синяк',
    'замёт',
    'мытьё',
    'всего',
    'бугор',
    'ягода',
    'князь',
    'прямо',
    'прыть',
    'фатум',
    'шитьё',
    'чепец',
    'брюхо',
    'голый',
    'вынос',
    'везде',
    'сюжет',
    'суфле',
    'бубен',
    'шалаш',
    'самец',
    'жених',
    'пятый',
    'намёк',
    'зверь',
    'выход',
    'выбор',
    'тёзка',
    'бабьё',
    'певец',
    'котёл',
    'монах',
    'общий',
    'копьё',
    'приём',
    'ухват',
    'кутья',
    'козлы',
    'фланг',
    'ущерб',
    'брошь',
    'пульс',
    'шашка',
    'одёжа',
    'снять',
    'жильё',
    'багаж',
    'рыбак',
    'пусть',
    'глупо',
    'хедер',
    'ввиду',
    'конюх',
    'барич',
    'лафит',
    'учить',
    'мигом',
    'дылда',
    'ижица',
    'тяжба',
    'бабий',
    'мразь',
    'тихий',
    'щипцы',
    'дюжий',
    'хлыст',
    'гость',
    'черёд',
    'южный',
    'поляк',
    'обрыв',
    'рядом',
    'хомут',
    'космы',
    'тугой',
    'шумок',
    'пузан',
    'камыш',
    'внизу',
    'сивый',
    'кожух',
    'грёза',
    'въезд',
    'порыв',
    'козёл',
    'щепка',
    'немец',
    'целый',
    'девиз',
    'грязь',
    'горох',
    'манеж',
    'башня',
    'рохля',
    'жулик',
    'акциз',
    'лысый',
    'заряд',
    'петля',
    'чугун',
    'поход',
    'ружьё',
    'чирей',
    'звать',
    'балык',
    'лицей',
    'запой',
    'шрифт',
    'душка',
    'груда',
    'бухта',
    'кутёж',
    'часть',
    'сумма',
    'мушка',
    'дрожь',
    'акция',
    'рыжий',
    'квиты',
    'фурор',
    'жилец',
    'сотый',
    'дуэль',
    'пышка',
    'смысл',
    'зубок',
    'келья',
    'приют',
    'гурия',
    'обруч',
    'фурия',
    'хорёк',
    'спесь',
    'вишня',
    'изъян',
    'будни',
    'лужок',
    'ямщик',
    'плечо',
    'зимой',
    'мишка',
    'рюмка',
    'аграф',
    'тюфяк',
    'чужой',
    'душок',
    'любой',
    'курсы',
    'посыл',
    'лихой',
    'глушь',
    'взять',
    'счёты',
    'исход',
    'леший',
    'цыган',
    'полюс',
    'вширь',
    'глыба',
    'помёт',
    'нищий',
    'смесь',
    'досуг',
    'отзыв',
    'пойма',
    'шейка',
    'пушок',
    'взрыв',
    'щенок',
    'пушка',
    'битьё',
    'жизнь',
    'казнь',
    'сыщик',
    'доход',
    'штраф',
    'вздох',
    'капля',
    'связь',
    'физик',
    'шлюха',
    'греча',
    'путём',
    'брюки',
    'умный',
    'чудно',
    'буфет',
    'месяц',
    'вьюга',
    'рубец',
    'нужно',
    'серый',
    'шёпот',
    'холст',
    'принц',
    'купец',
    'кукиш',
    'яркий',
    'дебош'
]
